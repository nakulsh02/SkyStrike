<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NAKUL: SOVEREIGN ULTIMATE</title>
    <style>
        :root { --neon: #00f2ff; --danger: #ff004c; --gold: #ffae00; --bg: #00050a; }
        body { margin: 0; background: var(--bg); overflow: hidden; font-family: 'Courier New', monospace; touch-action: none; color: white; }
        canvas { display: block; width: 100vw; height: 100vh; }

        /* Symmetrical HUD */
        #hud-top {
            position: absolute; top: 0; left: 0; width: 100%; height: 110px;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 50; background: linear-gradient(to bottom, rgba(0,242,255,0.2), transparent);
        }
        .hud-row { display: flex; justify-content: space-between; width: 92%; font-weight: bold; font-size: 1rem; color: var(--neon); text-shadow: 0 0 10px var(--neon); }
        
        #boss-ui { width: 85%; display: none; margin-top: 15px; flex-direction: column; align-items: center; }
        #boss-hp-bg { width: 100%; height: 10px; background: rgba(255,0,0,0.1); border: 2px solid var(--danger); border-radius: 5px; overflow: hidden; }
        #boss-hp-fill { height: 100%; width: 100%; background: var(--danger); box-shadow: 0 0 15px var(--danger); transition: width 0.1s; }

        /* PERFECT SYMMETRY GO! OVERLAY */
        #cd-overlay {
            position: absolute; top: 0; left: 0; width: 100vw; height: 100vh;
            display: none; 
            display: none; /* Controlled by JS */
            grid-template-columns: 1fr;
            grid-template-rows: 1fr;
            place-items: center; /* Vertical and Horizontal Center */
            z-index: 200; pointer-events: none;
        }
        #cd-text {
            font-size: 15rem; font-weight: 900; color: var(--neon);
            text-shadow: 0 0 50px var(--neon), 0 0 100px var(--neon);
            line-height: 0; margin: 0; padding: 0;
            text-align: center;
        }

        .overlay {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 85%; max-width: 400px; padding: 50px 0;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            background: rgba(0, 10, 20, 0.98); border: 2px solid var(--neon); border-radius: 30px;
            z-index: 100; text-align: center;
        }

        .btn { 
            background: var(--neon); color: #000; border: none; padding: 20px 60px; 
            font-size: 1.4rem; font-weight: 900; cursor: pointer; text-transform: uppercase; 
            margin-top: 30px; border-radius: 10px;
        }

        #warning {
            position: absolute; top: 35%; width: 100%; text-align: center;
            color: var(--danger); font-size: 3rem; display: none; z-index: 40;
            font-weight: 900; animation: blink 0.2s infinite;
        }
        @keyframes blink { 0%, 100% { opacity: 0; } 50% { opacity: 1; } }
    </style>
</head>
<body>

    <div id="hud-top">
        <div class="hud-row">
            <span>SCORE: <span id="sc-val">0</span></span>
            <span>PILOT: NAKUL</span>
        </div>
        <div id="boss-ui">
            <div id="boss-hp-bg"><div id="boss-hp-fill"></div></div>
        </div>
    </div>

    <div id="cd-overlay"><div id="cd-text">3</div></div>

    <div id="warning">⚠ BOSS ALERT ⚠</div>

    <div id="scr-start" class="overlay">
        <h1>Nakul's AIR STRIKER</h1>
        <div style="color:var(--gold); font-size: 1.1rem;">SOVEREIGN BATTLESHIP ACTIVE</div>
        <button class="btn" onclick="startCountdown()">ENGAGE</button>
    </div>

    <div id="scr-end" class="overlay" style="display:none;">
        <h1 style="color:var(--danger)">MISSION FAILED</h1>
        <div style="margin: 20px 0; font-size: 1.4rem;">SCORE: <span id="final-sc" style="color:var(--neon)">0</span></div>
        <button class="btn" onclick="startCountdown()">REBOOT</button>
    </div>

    <canvas id="c"></canvas>

<script>
    const canvas = document.getElementById('c');
    const ctx = canvas.getContext('2d');
    const scUI = document.getElementById('sc-val');
    const bossUI = document.getElementById('boss-ui');
    const bossFill = document.getElementById('boss-hp-fill');
    const cdOverlay = document.getElementById('cd-overlay');
    const cdText = document.getElementById('cd-text');

    let player, bullets, enemies, eBullets, stars, particles, score, active = false, boss = null;
    let lastFire = 0, difficulty = 1, bossCounter = 0, shake = 0;

    function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    window.onresize = resize; resize();

    function startCountdown() {
        document.getElementById('scr-start').style.display = 'none';
        document.getElementById('scr-end').style.display = 'none';
        cdOverlay.style.display = 'grid'; // Enable grid for symmetry
        let count = 3;
        cdText.innerText = count;
        let t = setInterval(() => {
            count--;
            if(count > 0) {
                cdText.innerText = count;
            } else if(count === 0) {
                cdText.innerText = "GO!";
            } else {
                clearInterval(t);
                cdOverlay.style.display = 'none';
                initMission();
            }
        }, 800);
    }

    function spawnExplosion(x, y, color, count = 15) {
        shake = 10;
        for(let i=0; i<count; i++) {
            particles.push({
                x, y, vx: (Math.random()-0.5)*15, vy: (Math.random()-0.5)*15,
                life: 1.0, color
            });
        }
    }

    class Boss {
        constructor(id) {
            this.type = id % 3;
            this.maxHp = 60 + (id * 40);
            this.hp = this.maxHp;
            this.x = canvas.width / 2; this.y = -150;
            this.color = ['#ff004c', '#bd00ff', '#ffae00'][this.type];
            this.lastShot = 0;
        }
        update() {
            if(this.y < 180) this.y += 2;
            this.x = (canvas.width/2) + Math.sin(Date.now()*0.002) * (canvas.width/3.5);
            if(Date.now() - this.lastShot > 1100 / difficulty) {
                const s = 4.5 * difficulty;
                for(let i=0; i<8; i++){
                    let a = (Math.PI*2/8)*i + (Date.now()*0.001);
                    eBullets.push({x:this.x, y:this.y, vx:Math.cos(a)*s, vy:Math.sin(a)*s, c:this.color});
                }
                this.lastShot = Date.now();
            }
        }
        draw() {
            ctx.fillStyle = this.color; ctx.shadowBlur = 30; ctx.shadowColor = this.color;
            if(this.type === 0) ctx.fillRect(this.x-80, this.y-40, 160, 80);
            else if(this.type === 1) { ctx.beginPath(); ctx.arc(this.x, this.y, 75, 0, 7); ctx.fill(); }
            else { ctx.beginPath(); ctx.moveTo(this.x-90, this.y-60); ctx.lineTo(this.x+90, this.y-60); ctx.lineTo(this.x, this.y+80); ctx.fill(); }
            ctx.shadowBlur = 0;
        }
    }

    class Enemy {
        constructor() {
            this.type = Math.floor(Math.random()*4);
            this.x = Math.random()*(canvas.width-60)+30; this.y = -50;
            const stats = [{c:'#ff004c',s:3.5},{c:'#bd00ff',s:2.2},{c:'#ffae00',s:1.5},{c:'#00ff66',s:2.8}];
            this.color = stats[this.type].c; this.speed = stats[this.type].s;
            this.lastShot = Date.now();
        }
        update() {
            this.y += this.speed * (0.85 + difficulty*0.15);
            if(Date.now() - this.lastShot > 2000/difficulty) { 
                eBullets.push({x:this.x, y:this.y, vx:0, vy:4.5*difficulty, c:this.color});
                this.lastShot = Date.now(); 
            }
        }
        draw() {
            ctx.fillStyle = this.color; ctx.beginPath();
            ctx.moveTo(this.x,this.y+20); ctx.lineTo(this.x-22,this.y-15); ctx.lineTo(this.x+22,this.y-15); ctx.fill();
        }
    }

    function initMission() {
        score = 0; difficulty = 1; bossCounter = 0; boss = null; active = true; shake = 0;
        scUI.innerText = "0"; bossUI.style.display = "none";
        bullets = []; enemies = []; eBullets = []; stars = []; particles = [];
        player = { x: canvas.width/2, y: canvas.height-120, tx: canvas.width/2, ty: canvas.height-120 };
        for(let i=0; i<80; i++) stars.push({x: Math.random()*canvas.width, y: Math.random()*canvas.height, s: Math.random()*2+1});
        loop();
    }

    window.onpointermove = (e) => {
        if(!active) return;
        let t = e.touches ? e.touches[0] : e;
        player.tx = t.clientX; player.ty = t.clientY;
    };

    function loop() {
        if(!active) return;
        difficulty += 0.0005;
        let sx = 0, sy = 0;
        if(shake > 0) { sx = (Math.random()-0.5)*shake; sy = (Math.random()-0.5)*shake; shake *= 0.9; }

        ctx.setTransform(1,0,0,1,sx,sy);
        ctx.fillStyle = '#00050a'; ctx.fillRect(-20, -20, canvas.width+40, canvas.height+40);

        stars.forEach(s => { 
            s.y += s.s * difficulty; if(s.y > canvas.height) s.y = 0; 
            ctx.fillStyle="#fff"; ctx.fillRect(s.x, s.y, 1, 2); 
        });

        particles.forEach((p, i) => {
            p.x += p.vx; p.y += p.vy; p.life -= 0.02;
            ctx.globalAlpha = p.life; ctx.fillStyle = p.color;
            ctx.fillRect(p.x, p.y, 3, 3);
            if(p.life <= 0) particles.splice(i, 1);
        });
        ctx.globalAlpha = 1;

        // Sovereign Battleship
        player.x += (player.tx - player.x) * 0.18;
        player.y += (player.ty - player.y) * 0.18;
        ctx.fillStyle = 'var(--neon)';
        ctx.fillRect(player.x-4, player.y-45, 8, 45);
        ctx.beginPath();
        ctx.moveTo(player.x-35, player.y+15); ctx.lineTo(player.x-10, player.y-20); ctx.lineTo(player.x-10, player.y+15); ctx.fill();
        ctx.moveTo(player.x+35, player.y+15); ctx.lineTo(player.x+10, player.y-20); ctx.lineTo(player.x+10, player.y+15); ctx.fill();

        if(Date.now() - lastFire > 160) { bullets.push({x: player.x, y: player.y-45}); lastFire = Date.now(); }
        bullets.forEach((b, i) => {
            b.y -= 20; ctx.fillStyle = '#fff'; ctx.fillRect(b.x-2, b.y, 4, 18);
            if(boss && Math.hypot(b.x-boss.x, b.y-boss.y) < 70) {
                boss.hp--; bullets.splice(i,1);
                spawnExplosion(b.x, b.y, 'white', 2);
                bossFill.style.width = (boss.hp/boss.maxHp*100) + "%";
                if(boss.hp <= 0) { 
                    spawnExplosion(boss.x, boss.y, boss.color, 60);
                    shake = 25;
                    boss = null; score += 1000; bossUI.style.display='none'; scUI.innerText=score; bossCounter++; 
                }
            }
            if(b.y < -50) bullets.splice(i, 1);
        });

        if(score >= 400 && score % 400 < 15 && !boss) {
            document.getElementById('warning').style.display='block';
            setTimeout(() => { 
                document.getElementById('warning').style.display='none'; 
                boss = new Boss(bossCounter); bossUI.style.display='flex'; bossFill.style.width="100%"; 
            }, 2000);
            score += 20;
        }

        if(boss) { boss.update(); boss.draw(); if(Math.hypot(boss.x-player.x, boss.y-player.y) < 80) active = false; }
        else { if(Math.random() < 0.035 + (difficulty*0.005)) enemies.push(new Enemy()); }

        eBullets.forEach((eb, i) => {
            eb.x += eb.vx || 0; eb.y += eb.vy;
            ctx.fillStyle = eb.c; ctx.beginPath(); ctx.arc(eb.x, eb.y, 6, 0, 7); ctx.fill();
            if(Math.hypot(eb.x-player.x, eb.y-player.y) < 25) { spawnExplosion(player.x, player.y, 'var(--neon)', 30); active = false; }
            if(eb.y > canvas.height || eb.y < -350) eBullets.splice(i,1);
        });

        enemies.forEach((e, i) => {
            e.update(); e.draw();
            bullets.forEach((b, bi) => { 
                if(Math.hypot(e.x-b.x, e.y-b.y) < 35) { 
                    spawnExplosion(e.x, e.y, e.color, 12);
                    enemies.splice(i, 1); bullets.splice(bi, 1); score += 10; scUI.innerText = score; 
                } 
            });
            if(Math.hypot(e.x-player.x, e.y-player.y) < 38) active = false;
            if(e.y > canvas.height + 60) enemies.splice(i, 1);
        });

        if(!active) { 
            ctx.setTransform(1,0,0,1,0,0);
            document.getElementById('scr-end').style.display = 'flex'; 
            document.getElementById('final-sc').innerText = score; 
        } else {
            requestAnimationFrame(loop);
        }
    }
</script>
</body>
</html>
